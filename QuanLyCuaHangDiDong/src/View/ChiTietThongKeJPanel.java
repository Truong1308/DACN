/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package View;

import Database.ConnectDB;
import java.io.BufferedOutputStream;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.FileWriter;
import java.io.IOException;
import java.io.Writer;
import static java.lang.System.out;
import java.sql.Date;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.text.NumberFormat;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Locale;

import javax.swing.DefaultComboBoxModel;
import javax.swing.JComboBox;
import javax.swing.JFileChooser;
import javax.swing.JFrame;
import javax.swing.JOptionPane;
import javax.swing.JTable;
import javax.swing.table.DefaultTableModel;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.ImageIcon;
import javax.swing.JLabel;
import javax.swing.filechooser.FileNameExtensionFilter;
import org.apache.poi.xssf.usermodel.XSSFCell;
import org.apache.poi.xssf.usermodel.XSSFRow;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;




/**
 *
 * @author nguye
 */
public class ChiTietThongKeJPanel extends javax.swing.JPanel 
{
    ConnectDB cnn = new ConnectDB();
    
    Locale localeVN = new Locale("vi", "VN");
    NumberFormat currencyVN = NumberFormat.getCurrencyInstance(localeVN);
    
    Calendar cal = Calendar.getInstance();
    int day = cal.get(Calendar.DAY_OF_MONTH);
    int month = cal.get(Calendar.MONTH) + 1;
    int year = cal.get(Calendar.YEAR);
    /**
     * Creates new form ChiTietThongKeJPanel
     */
    public ChiTietThongKeJPanel() {
        initComponents();
        HiencbbNgayThangNam();
        Show();
        HienGiaiDoan();
        HienVon();
        LayDuLieuVonThuHoi();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jTabbedPane2 = new javax.swing.JTabbedPane();
        jPanel1 = new javax.swing.JPanel();
        jPanel2 = new javax.swing.JPanel();
        cbbNgay1 = new javax.swing.JComboBox<>();
        cbbThang1 = new javax.swing.JComboBox<>();
        cbbNam1 = new javax.swing.JComboBox<>();
        cbbNgay2 = new javax.swing.JComboBox<>();
        cbbThang2 = new javax.swing.JComboBox<>();
        cbbNam2 = new javax.swing.JComboBox<>();
        jLabel1 = new javax.swing.JLabel();
        jTabbedPane1 = new javax.swing.JTabbedPane();
        jPanel4 = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        tblThongKeChiTiet = new javax.swing.JTable();
        btnXuatLoi = new javax.swing.JButton();
        jPanel5 = new javax.swing.JPanel();
        jPanel6 = new javax.swing.JPanel();
        jScrollPane2 = new javax.swing.JScrollPane();
        tblLo = new javax.swing.JTable();
        btnXuatLo = new javax.swing.JButton();
        jPanel23 = new javax.swing.JPanel();
        jPanel24 = new javax.swing.JPanel();
        jScrollPane8 = new javax.swing.JScrollPane();
        tblChiTietBan = new javax.swing.JTable();
        jButton3 = new javax.swing.JButton();
        jPanel3 = new javax.swing.JPanel();
        jButton1 = new javax.swing.JButton();
        jPanel7 = new javax.swing.JPanel();
        jPanel8 = new javax.swing.JPanel();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        txtNgayBatDau = new javax.swing.JTextField();
        jLabel4 = new javax.swing.JLabel();
        txtNgayKeThuc = new javax.swing.JTextField();
        jLabel5 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        jLabel7 = new javax.swing.JLabel();
        txtTongDoanhThuLoi = new javax.swing.JTextField();
        txtLoiNhuan = new javax.swing.JTextField();
        txtTongVonBanDauLoi = new javax.swing.JTextField();
        jLabel14 = new javax.swing.JLabel();
        txtPhiBaoHanh = new javax.swing.JTextField();
        jPanel9 = new javax.swing.JPanel();
        jLabel8 = new javax.swing.JLabel();
        txtNgayBatDau1 = new javax.swing.JTextField();
        txtNgayKeThuc1 = new javax.swing.JTextField();
        jLabel9 = new javax.swing.JLabel();
        jLabel10 = new javax.swing.JLabel();
        txtTongDoanhThuLo = new javax.swing.JTextField();
        jLabel11 = new javax.swing.JLabel();
        txtTongVoLo = new javax.swing.JTextField();
        jLabel12 = new javax.swing.JLabel();
        txtLo = new javax.swing.JTextField();
        jLabel13 = new javax.swing.JLabel();
        jLabel15 = new javax.swing.JLabel();
        txtPhiBaoHanhLo = new javax.swing.JTextField();
        jPanel10 = new javax.swing.JPanel();
        jLabel16 = new javax.swing.JLabel();
        jLabel17 = new javax.swing.JLabel();
        jLabel18 = new javax.swing.JLabel();
        jLabel19 = new javax.swing.JLabel();
        jLabel20 = new javax.swing.JLabel();
        jLabel21 = new javax.swing.JLabel();
        txtTienDien = new javax.swing.JTextField();
        txtTienNuoc = new javax.swing.JTextField();
        txtTienMatBang = new javax.swing.JTextField();
        txtTienInternet = new javax.swing.JTextField();
        txtTienDienThoai = new javax.swing.JTextField();
        btnOK = new javax.swing.JButton();
        jPanel11 = new javax.swing.JPanel();
        jLabel22 = new javax.swing.JLabel();
        jLabel23 = new javax.swing.JLabel();
        jLabel24 = new javax.swing.JLabel();
        jLabel25 = new javax.swing.JLabel();
        jLabel26 = new javax.swing.JLabel();
        jLabel27 = new javax.swing.JLabel();
        txtLoiNhuanTK = new javax.swing.JTextField();
        txtThuaLoTK = new javax.swing.JTextField();
        txtPhiBaoHanhTK = new javax.swing.JTextField();
        txtLuongNVTK = new javax.swing.JTextField();
        txtChiPhiPhatSinhTK = new javax.swing.JTextField();
        jLabel28 = new javax.swing.JLabel();
        txtTongTK = new javax.swing.JTextField();
        jButton2 = new javax.swing.JButton();
        jPanel16 = new javax.swing.JPanel();
        jPanel17 = new javax.swing.JPanel();
        jScrollPane5 = new javax.swing.JScrollPane();
        tblQuyetToan = new javax.swing.JTable();
        jPanel18 = new javax.swing.JPanel();
        jPanel19 = new javax.swing.JPanel();
        jScrollPane6 = new javax.swing.JScrollPane();
        tblGiaDoan = new javax.swing.JTable();
        jPanel20 = new javax.swing.JPanel();
        jLabel32 = new javax.swing.JLabel();
        jPanel21 = new javax.swing.JPanel();
        jLabel33 = new javax.swing.JLabel();
        btnThuHoiVon = new javax.swing.JButton();
        jPanel12 = new javax.swing.JPanel();
        jPanel13 = new javax.swing.JPanel();
        jScrollPane3 = new javax.swing.JScrollPane();
        tblVonThem = new javax.swing.JTable();
        jPanel14 = new javax.swing.JPanel();
        jLabel29 = new javax.swing.JLabel();
        jLabel30 = new javax.swing.JLabel();
        txtVonThem = new javax.swing.JTextField();
        jScrollPane4 = new javax.swing.JScrollPane();
        txtGhiChuVonThem = new javax.swing.JTextArea();
        jLabel31 = new javax.swing.JLabel();
        txtMaVOn = new javax.swing.JTextField();
        jPanel15 = new javax.swing.JPanel();
        btnThemVon = new javax.swing.JButton();
        btnSua = new javax.swing.JButton();
        jPanel22 = new javax.swing.JPanel();
        jScrollPane7 = new javax.swing.JScrollPane();
        tblVonThuHoi = new javax.swing.JTable();

        cbbThang1.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                cbbThang1ItemStateChanged(evt);
            }
        });

        cbbNam1.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                cbbNam1ItemStateChanged(evt);
            }
        });

        cbbThang2.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                cbbThang2ItemStateChanged(evt);
            }
        });

        cbbNam2.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                cbbNam2ItemStateChanged(evt);
            }
        });

        jLabel1.setFont(new java.awt.Font("Tahoma", 0, 36)); // NOI18N
        jLabel1.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel1.setText("~");

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(cbbNgay1, javax.swing.GroupLayout.PREFERRED_SIZE, 69, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(cbbThang1, javax.swing.GroupLayout.PREFERRED_SIZE, 64, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(cbbNam1, javax.swing.GroupLayout.PREFERRED_SIZE, 81, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(59, 59, 59)
                .addComponent(jLabel1)
                .addGap(59, 59, 59)
                .addComponent(cbbNgay2, javax.swing.GroupLayout.PREFERRED_SIZE, 69, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(cbbThang2, javax.swing.GroupLayout.PREFERRED_SIZE, 64, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(cbbNam2, javax.swing.GroupLayout.PREFERRED_SIZE, 81, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(cbbNgay2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(cbbThang2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(cbbNam2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(cbbNam1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(cbbThang1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(cbbNgay1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel1))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        tblThongKeChiTiet.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null}
            },
            new String [] {
                "STT", "Tên Sản Phẩm", "Ngày Bán", "Khách Hàng", "Tổng Tiền"
            }
        ));
        jScrollPane1.setViewportView(tblThongKeChiTiet);

        btnXuatLoi.setText("Xuất Excel");
        btnXuatLoi.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnXuatLoiActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane1, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 878, Short.MAX_VALUE)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel4Layout.createSequentialGroup()
                        .addGap(0, 0, Short.MAX_VALUE)
                        .addComponent(btnXuatLoi, javax.swing.GroupLayout.PREFERRED_SIZE, 98, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap())
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(btnXuatLoi)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 337, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(15, 15, 15))
        );

        jTabbedPane1.addTab("Sản Phẩm Bán Lời", jPanel4);

        tblLo.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "STT", "Tên Sản Phẩm", "Ngày Bán", "Tổng Tiền"
            }
        ));
        jScrollPane2.setViewportView(tblLo);

        btnXuatLo.setText("Xuất Excel");
        btnXuatLo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnXuatLoActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
        jPanel6.setLayout(jPanel6Layout);
        jPanel6Layout.setHorizontalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel6Layout.createSequentialGroup()
                        .addGap(0, 0, Short.MAX_VALUE)
                        .addComponent(btnXuatLo))
                    .addComponent(jScrollPane2, javax.swing.GroupLayout.DEFAULT_SIZE, 878, Short.MAX_VALUE))
                .addContainerGap())
        );
        jPanel6Layout.setVerticalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(btnXuatLo)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane2, javax.swing.GroupLayout.DEFAULT_SIZE, 336, Short.MAX_VALUE)
                .addContainerGap())
        );

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel6, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel6, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );

        jTabbedPane1.addTab("Sản Phẩm Bán Lỗ", jPanel5);

        tblChiTietBan.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        jScrollPane8.setViewportView(tblChiTietBan);

        javax.swing.GroupLayout jPanel24Layout = new javax.swing.GroupLayout(jPanel24);
        jPanel24.setLayout(jPanel24Layout);
        jPanel24Layout.setHorizontalGroup(
            jPanel24Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel24Layout.createSequentialGroup()
                .addGap(197, 197, 197)
                .addComponent(jScrollPane8, javax.swing.GroupLayout.PREFERRED_SIZE, 600, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(101, Short.MAX_VALUE))
        );
        jPanel24Layout.setVerticalGroup(
            jPanel24Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel24Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane8, javax.swing.GroupLayout.DEFAULT_SIZE, 299, Short.MAX_VALUE)
                .addContainerGap())
        );

        jButton3.setText("Xuất Excel");
        jButton3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton3ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel23Layout = new javax.swing.GroupLayout(jPanel23);
        jPanel23.setLayout(jPanel23Layout);
        jPanel23Layout.setHorizontalGroup(
            jPanel23Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel24, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel23Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jButton3)
                .addGap(97, 97, 97))
        );
        jPanel23Layout.setVerticalGroup(
            jPanel23Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel23Layout.createSequentialGroup()
                .addContainerGap(14, Short.MAX_VALUE)
                .addComponent(jButton3)
                .addGap(18, 18, 18)
                .addComponent(jPanel24, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        jTabbedPane1.addTab("Chi Tiết", jPanel23);

        jButton1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Image/loupe.png"))); // NOI18N
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jButton1)
                .addGap(10, 10, 10))
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jButton1, javax.swing.GroupLayout.PREFERRED_SIZE, 44, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(76, 76, 76)
                .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGap(105, 105, 105)
                .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGap(49, 49, 49))
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jTabbedPane1)
                .addContainerGap())
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addGap(3, 3, 3))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addGap(5, 5, 5)))
                .addComponent(jTabbedPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 415, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(117, 117, 117))
        );

        jTabbedPane2.addTab("Xem Tổng Cục", jPanel1);

        jPanel8.setBackground(new java.awt.Color(255, 255, 204));

        jLabel2.setText("BÁO CÁO DOANH THU SINH LỢI NHUẬN");

        jLabel3.setText("Từ ngày:");

        txtNgayBatDau.setEditable(false);

        jLabel4.setText("Đến ngày:");

        txtNgayKeThuc.setEditable(false);

        jLabel5.setText("Tổng doanh thu:");

        jLabel6.setText("Tổng vốn ban đầu:");

        jLabel7.setText("Lợi nhuận:");

        txtTongDoanhThuLoi.setEditable(false);

        txtLoiNhuan.setEditable(false);

        txtTongVonBanDauLoi.setEditable(false);

        jLabel14.setText("Tổng Phí Bảo Hành:");

        txtPhiBaoHanh.setEditable(false);

        javax.swing.GroupLayout jPanel8Layout = new javax.swing.GroupLayout(jPanel8);
        jPanel8.setLayout(jPanel8Layout);
        jPanel8Layout.setHorizontalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel8Layout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel5, javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(jLabel6, javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(jLabel7, javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(jLabel14, javax.swing.GroupLayout.Alignment.TRAILING))
                        .addGap(42, 42, 42)
                        .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                            .addComponent(txtLoiNhuan)
                            .addComponent(txtPhiBaoHanh)
                            .addComponent(txtTongVonBanDauLoi)
                            .addComponent(txtTongDoanhThuLoi)))
                    .addGroup(jPanel8Layout.createSequentialGroup()
                        .addGap(33, 33, 33)
                        .addComponent(jLabel3)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txtNgayBatDau, javax.swing.GroupLayout.DEFAULT_SIZE, 112, Short.MAX_VALUE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jLabel4)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txtNgayKeThuc, javax.swing.GroupLayout.PREFERRED_SIZE, 128, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel8Layout.createSequentialGroup()
                        .addGap(102, 102, 102)
                        .addComponent(jLabel2)
                        .addGap(2, 2, 2)))
                .addGap(19, 19, 19))
        );
        jPanel8Layout.setVerticalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addGap(15, 15, 15)
                .addComponent(jLabel2, javax.swing.GroupLayout.PREFERRED_SIZE, 14, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(25, 25, 25)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(jLabel3)
                    .addComponent(txtNgayBatDau, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtNgayKeThuc, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel4))
                .addGap(25, 25, 25)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(jLabel5)
                    .addComponent(txtTongDoanhThuLoi, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(25, 25, 25)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(jLabel6)
                    .addComponent(txtTongVonBanDauLoi, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(25, 25, 25)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel7)
                    .addComponent(txtLoiNhuan, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(25, 25, 25)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(jLabel14)
                    .addComponent(txtPhiBaoHanh, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(15, 15, 15))
        );

        jPanel9.setBackground(new java.awt.Color(255, 204, 204));

        jLabel8.setText("Từ ngày:");

        txtNgayBatDau1.setEditable(false);

        txtNgayKeThuc1.setEditable(false);

        jLabel9.setText("Đến ngày:");

        jLabel10.setText("Tổng doanh thu:");

        txtTongDoanhThuLo.setEditable(false);

        jLabel11.setText("Tổng vốn ban đầu:");

        txtTongVoLo.setEditable(false);

        jLabel12.setText("Thua lỗ:");

        txtLo.setEditable(false);

        jLabel13.setText("BÁO CÁO DOANH THU KHÔNG SINH LỢI NHUẬN");

        jLabel15.setText("Tổng Phí Bảo Hành:");

        txtPhiBaoHanhLo.setEditable(false);

        javax.swing.GroupLayout jPanel9Layout = new javax.swing.GroupLayout(jPanel9);
        jPanel9.setLayout(jPanel9Layout);
        jPanel9Layout.setHorizontalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addGap(22, 22, 22)
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel9Layout.createSequentialGroup()
                        .addGap(23, 23, 23)
                        .addComponent(jLabel8)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel13)
                            .addGroup(jPanel9Layout.createSequentialGroup()
                                .addComponent(txtNgayBatDau1, javax.swing.GroupLayout.DEFAULT_SIZE, 112, Short.MAX_VALUE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jLabel9)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(txtNgayKeThuc1, javax.swing.GroupLayout.DEFAULT_SIZE, 117, Short.MAX_VALUE))))
                    .addGroup(jPanel9Layout.createSequentialGroup()
                        .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel15, javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(jLabel12, javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(jLabel11, javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(jLabel10, javax.swing.GroupLayout.Alignment.TRAILING))
                        .addGap(42, 42, 42)
                        .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                            .addComponent(txtPhiBaoHanhLo)
                            .addComponent(txtLo)
                            .addComponent(txtTongVoLo)
                            .addComponent(txtTongDoanhThuLo))))
                .addGap(20, 20, 20))
        );
        jPanel9Layout.setVerticalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addGap(15, 15, 15)
                .addComponent(jLabel13)
                .addGap(25, 25, 25)
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(jLabel8)
                    .addComponent(txtNgayBatDau1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtNgayKeThuc1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel9))
                .addGap(25, 25, 25)
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(jLabel10)
                    .addComponent(txtTongDoanhThuLo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(25, 25, 25)
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(jLabel11)
                    .addComponent(txtTongVoLo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(25, 25, 25)
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel12)
                    .addComponent(txtLo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(25, 25, 25)
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(jLabel15)
                    .addComponent(txtPhiBaoHanhLo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(15, 15, 15))
        );

        jPanel10.setBackground(new java.awt.Color(204, 255, 204));

        jLabel16.setText("CÁC CHI PHÍ PHÁT SINH HÀNG THÁNG");

        jLabel17.setText("Tiền điện:");

        jLabel18.setText("Tiền nước:");

        jLabel19.setText("Tiền thuê mặt bằng:");

        jLabel20.setText("Tiền Internet:");

        jLabel21.setText("Tiền điện thoại:");

        btnOK.setText("OK");
        btnOK.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnOKActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel10Layout = new javax.swing.GroupLayout(jPanel10);
        jPanel10.setLayout(jPanel10Layout);
        jPanel10Layout.setHorizontalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jLabel21)
                    .addComponent(jLabel20)
                    .addComponent(jLabel19)
                    .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addComponent(jLabel17)
                        .addComponent(jLabel18)))
                .addGap(41, 41, 41)
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(txtTienDien)
                    .addComponent(txtTienNuoc)
                    .addComponent(txtTienMatBang)
                    .addComponent(txtTienInternet)
                    .addComponent(txtTienDienThoai)
                    .addComponent(btnOK))
                .addGap(36, 36, 36))
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jLabel16)
                .addGap(101, 101, 101))
        );
        jPanel10Layout.setVerticalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel16)
                .addGap(18, 18, 18)
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(txtTienDien, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel17))
                .addGap(15, 15, 15)
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(jLabel18)
                    .addComponent(txtTienNuoc, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(15, 15, 15)
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(jLabel19)
                    .addComponent(txtTienMatBang, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(15, 15, 15)
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(jLabel20)
                    .addComponent(txtTienInternet, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(15, 15, 15)
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(jLabel21)
                    .addComponent(txtTienDienThoai, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(btnOK)
                .addContainerGap())
        );

        jPanel11.setBackground(new java.awt.Color(204, 204, 255));

        jLabel22.setText("THỐNG KÊ");

        jLabel23.setText("Lợi nhuận:");

        jLabel24.setText("Thua lỗ:");

        jLabel25.setText("Phí bảo hành:");

        jLabel26.setText("Lương nhân viên:");

        jLabel27.setText("Chi phí phát sinh:");

        txtLoiNhuanTK.setEditable(false);

        txtThuaLoTK.setEditable(false);

        txtPhiBaoHanhTK.setEditable(false);

        txtLuongNVTK.setEditable(false);

        txtChiPhiPhatSinhTK.setEditable(false);

        jLabel28.setText("TỔNG:");

        txtTongTK.setEditable(false);

        javax.swing.GroupLayout jPanel11Layout = new javax.swing.GroupLayout(jPanel11);
        jPanel11.setLayout(jPanel11Layout);
        jPanel11Layout.setHorizontalGroup(
            jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel11Layout.createSequentialGroup()
                .addGap(37, 37, 37)
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel11Layout.createSequentialGroup()
                        .addComponent(jLabel22)
                        .addGap(168, 168, 168))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel11Layout.createSequentialGroup()
                        .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(jLabel28)
                            .addComponent(jLabel24)
                            .addComponent(jLabel27)
                            .addComponent(jLabel26)
                            .addComponent(jLabel25)
                            .addComponent(jLabel23))
                        .addGap(38, 38, 38)
                        .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(txtThuaLoTK, javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(txtLoiNhuanTK, javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(txtChiPhiPhatSinhTK)
                            .addComponent(txtLuongNVTK)
                            .addComponent(txtPhiBaoHanhTK, javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(txtTongTK, javax.swing.GroupLayout.Alignment.TRAILING))
                        .addGap(21, 21, 21))))
        );
        jPanel11Layout.setVerticalGroup(
            jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel11Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel22)
                .addGap(6, 6, 6)
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(jLabel23, javax.swing.GroupLayout.PREFERRED_SIZE, 22, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtLoiNhuanTK, javax.swing.GroupLayout.PREFERRED_SIZE, 22, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(15, 15, 15)
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(jLabel24)
                    .addComponent(txtThuaLoTK, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(15, 15, 15)
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(jLabel25)
                    .addComponent(txtPhiBaoHanhTK, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(15, 15, 15)
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(jLabel26)
                    .addComponent(txtLuongNVTK, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(15, 15, 15)
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(jLabel27)
                    .addComponent(txtChiPhiPhatSinhTK, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(38, 38, 38)
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtTongTK, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel28))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jButton2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Image/save-file.png"))); // NOI18N
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel7Layout = new javax.swing.GroupLayout(jPanel7);
        jPanel7.setLayout(jPanel7Layout);
        jPanel7Layout.setHorizontalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel8, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jPanel10, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addGap(18, 18, 18)
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel9, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel11, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jButton2, javax.swing.GroupLayout.DEFAULT_SIZE, 77, Short.MAX_VALUE)
                .addGap(10, 10, 10))
        );
        jPanel7Layout.setVerticalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel8, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jPanel9, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addGap(18, 18, 18)
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel11, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel10, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel7Layout.createSequentialGroup()
                        .addGap(186, 186, 186)
                        .addComponent(jButton2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                .addGap(15, 15, 15))
        );

        jTabbedPane2.addTab("Báo Cáo Chi Tiết", jPanel7);

        tblQuyetToan.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null}
            },
            new String [] {
                "Tổng Doanh Thu", "Vốn Lỗ", "Lương Nhân Viên", "Chi Phí Tháng", "Tiền Bảo Hành"
            }
        ));
        jScrollPane5.setViewportView(tblQuyetToan);

        javax.swing.GroupLayout jPanel17Layout = new javax.swing.GroupLayout(jPanel17);
        jPanel17.setLayout(jPanel17Layout);
        jPanel17Layout.setHorizontalGroup(
            jPanel17Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel17Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane5)
                .addContainerGap())
        );
        jPanel17Layout.setVerticalGroup(
            jPanel17Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel17Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane5, javax.swing.GroupLayout.PREFERRED_SIZE, 143, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(15, 15, 15))
        );

        tblGiaDoan.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null},
                {null, null, null},
                {null, null, null},
                {null, null, null}
            },
            new String [] {
                "STT", "Ngày Bắt Đầu", "Ngày Kết Thúc"
            }
        ));
        tblGiaDoan.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tblGiaDoanMouseClicked(evt);
            }
        });
        jScrollPane6.setViewportView(tblGiaDoan);

        javax.swing.GroupLayout jPanel19Layout = new javax.swing.GroupLayout(jPanel19);
        jPanel19.setLayout(jPanel19Layout);
        jPanel19Layout.setHorizontalGroup(
            jPanel19Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel19Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jScrollPane6, javax.swing.GroupLayout.PREFERRED_SIZE, 442, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );
        jPanel19Layout.setVerticalGroup(
            jPanel19Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel19Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jScrollPane6, javax.swing.GroupLayout.PREFERRED_SIZE, 137, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(301, 301, 301))
        );

        jLabel32.setFont(new java.awt.Font("Times New Roman", 1, 18)); // NOI18N
        jLabel32.setForeground(new java.awt.Color(51, 0, 255));
        jLabel32.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel32.setText("CÁC GIAI ĐOẠN THỐNG KÊ");

        javax.swing.GroupLayout jPanel20Layout = new javax.swing.GroupLayout(jPanel20);
        jPanel20.setLayout(jPanel20Layout);
        jPanel20Layout.setHorizontalGroup(
            jPanel20Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel20Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel32, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel20Layout.setVerticalGroup(
            jPanel20Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel20Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel32, javax.swing.GroupLayout.DEFAULT_SIZE, 32, Short.MAX_VALUE)
                .addContainerGap())
        );

        javax.swing.GroupLayout jPanel18Layout = new javax.swing.GroupLayout(jPanel18);
        jPanel18.setLayout(jPanel18Layout);
        jPanel18Layout.setHorizontalGroup(
            jPanel18Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel18Layout.createSequentialGroup()
                .addGap(189, 189, 189)
                .addComponent(jPanel19, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGap(252, 252, 252))
            .addGroup(jPanel18Layout.createSequentialGroup()
                .addGap(300, 300, 300)
                .addComponent(jPanel20, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGap(339, 339, 339))
        );
        jPanel18Layout.setVerticalGroup(
            jPanel18Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel18Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel20, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel19, javax.swing.GroupLayout.PREFERRED_SIZE, 165, Short.MAX_VALUE)
                .addContainerGap())
        );

        jLabel33.setFont(new java.awt.Font("Times New Roman", 1, 18)); // NOI18N
        jLabel33.setForeground(new java.awt.Color(0, 0, 255));
        jLabel33.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel33.setText("CÁC SỐ LIỆU THỐNG KÊ");

        javax.swing.GroupLayout jPanel21Layout = new javax.swing.GroupLayout(jPanel21);
        jPanel21.setLayout(jPanel21Layout);
        jPanel21Layout.setHorizontalGroup(
            jPanel21Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel21Layout.createSequentialGroup()
                .addGap(10, 10, 10)
                .addComponent(jLabel33, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGap(10, 10, 10))
        );
        jPanel21Layout.setVerticalGroup(
            jPanel21Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel21Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel33, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );

        btnThuHoiVon.setText("Thu Hồi Vốn");
        btnThuHoiVon.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThuHoiVonActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel16Layout = new javax.swing.GroupLayout(jPanel16);
        jPanel16.setLayout(jPanel16Layout);
        jPanel16Layout.setHorizontalGroup(
            jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel16Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel18, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel17, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
            .addGroup(jPanel16Layout.createSequentialGroup()
                .addGap(300, 300, 300)
                .addComponent(jPanel21, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGap(341, 341, 341))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel16Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(btnThuHoiVon)
                .addGap(145, 145, 145))
        );
        jPanel16Layout.setVerticalGroup(
            jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel16Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel18, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel21, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel17, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGap(32, 32, 32)
                .addComponent(btnThuHoiVon)
                .addGap(32, 32, 32))
        );

        jTabbedPane2.addTab("Chi Tiết Thống Kê ", jPanel16);

        tblVonThem.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null}
            },
            new String [] {
                "Mã Vốn", "Vốn Thêm", "Ngày Thêm", "Tổng Vốn", "Ghi Chú"
            }
        ));
        jScrollPane3.setViewportView(tblVonThem);

        javax.swing.GroupLayout jPanel13Layout = new javax.swing.GroupLayout(jPanel13);
        jPanel13.setLayout(jPanel13Layout);
        jPanel13Layout.setHorizontalGroup(
            jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel13Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane3, javax.swing.GroupLayout.DEFAULT_SIZE, 520, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel13Layout.setVerticalGroup(
            jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel13Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane3, javax.swing.GroupLayout.DEFAULT_SIZE, 150, Short.MAX_VALUE)
                .addContainerGap())
        );

        jLabel29.setText("Vốn Thêm:");

        jLabel30.setText("Ghi Chú:");

        txtGhiChuVonThem.setColumns(20);
        txtGhiChuVonThem.setRows(5);
        jScrollPane4.setViewportView(txtGhiChuVonThem);

        jLabel31.setText("Mã Vốn:");

        txtMaVOn.setEditable(false);

        javax.swing.GroupLayout jPanel14Layout = new javax.swing.GroupLayout(jPanel14);
        jPanel14.setLayout(jPanel14Layout);
        jPanel14Layout.setHorizontalGroup(
            jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel14Layout.createSequentialGroup()
                .addGroup(jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel14Layout.createSequentialGroup()
                        .addGap(20, 20, 20)
                        .addComponent(jLabel30))
                    .addGroup(jPanel14Layout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(jLabel31)
                            .addComponent(jLabel29))))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(txtMaVOn)
                    .addComponent(txtVonThem)
                    .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel14Layout.setVerticalGroup(
            jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel14Layout.createSequentialGroup()
                .addGap(25, 25, 25)
                .addGroup(jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel31)
                    .addComponent(txtMaVOn, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel29)
                    .addComponent(txtVonThem, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel14Layout.createSequentialGroup()
                        .addComponent(jLabel30)
                        .addGap(0, 46, Short.MAX_VALUE))
                    .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE))
                .addContainerGap())
        );

        btnThemVon.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Image/add.png"))); // NOI18N
        btnThemVon.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThemVonActionPerformed(evt);
            }
        });

        btnSua.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Image/rotation.png"))); // NOI18N
        btnSua.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSuaActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel15Layout = new javax.swing.GroupLayout(jPanel15);
        jPanel15.setLayout(jPanel15Layout);
        jPanel15Layout.setHorizontalGroup(
            jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel15Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(btnThemVon, javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(btnSua, javax.swing.GroupLayout.Alignment.TRAILING))
                .addContainerGap())
        );
        jPanel15Layout.setVerticalGroup(
            jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel15Layout.createSequentialGroup()
                .addGap(22, 22, 22)
                .addComponent(btnThemVon)
                .addGap(18, 18, 18)
                .addComponent(btnSua)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        tblVonThuHoi.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Mã Vốn", "Mã Thống Kê", "Vốn Thu Hồi", "Ngày Thu Hồi"
            }
        ));
        jScrollPane7.setViewportView(tblVonThuHoi);

        javax.swing.GroupLayout jPanel22Layout = new javax.swing.GroupLayout(jPanel22);
        jPanel22.setLayout(jPanel22Layout);
        jPanel22Layout.setHorizontalGroup(
            jPanel22Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel22Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane7)
                .addContainerGap())
        );
        jPanel22Layout.setVerticalGroup(
            jPanel22Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel22Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane7, javax.swing.GroupLayout.PREFERRED_SIZE, 228, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(30, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jPanel12Layout = new javax.swing.GroupLayout(jPanel12);
        jPanel12.setLayout(jPanel12Layout);
        jPanel12Layout.setHorizontalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jPanel22, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel13, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel14, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel15, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(43, Short.MAX_VALUE))
        );
        jPanel12Layout.setVerticalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel12Layout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jPanel14, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jPanel13, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(jPanel12Layout.createSequentialGroup()
                        .addGap(45, 45, 45)
                        .addComponent(jPanel15, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel22, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(112, Short.MAX_VALUE))
        );

        jTabbedPane2.addTab("Báo cáo vốn", jPanel12);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jTabbedPane2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(jTabbedPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 598, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
    }// </editor-fold>//GEN-END:initComponents
    int tam =0;
    private void cbbThang1ItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_cbbThang1ItemStateChanged
        // TODO add your handling code here:
        String thang = cbbThang1.getSelectedItem().toString();
        DefaultComboBoxModel cbbmodel = new DefaultComboBoxModel();
        String thanght;
        if (tam == 0) {
            thanght = "0";
        } else {
            thanght = cbbNgay1.getSelectedItem().toString();
        }
        tam = 1;

        if (thang.equals("4") || thang.equals("6") || thang.equals("9") || thang.equals("11")) {
            cbbNgay1.setModel(cbbmodel);
            for (int i = 1; i < 31; i++) {
                cbbNgay1.addItem(String.valueOf(i));
            }
            if (Integer.valueOf(thanght) < 31) {
                cbbNgay1.setSelectedItem(thanght);
            }
        } else if (thang.equals("1") || thang.equals("3") || thang.equals("5")
            || thang.equals("7") || thang.equals("8") || thang.equals("12") || thang.equals("10")) {

            cbbNgay1.setModel(cbbmodel);
            for (int i = 1; i < 32; i++) {
                cbbNgay1.addItem(String.valueOf(i));
            }
            if (Integer.valueOf(thanght) < 32) {
                cbbNgay1.setSelectedItem(thanght);
            }
        }
        else if((Integer.parseInt(cbbNam1.getSelectedItem().toString())%4==0
                &&(Integer.parseInt(cbbNam1.getSelectedItem().toString())%100!=0)
                ||Integer.parseInt(cbbNam1.getSelectedItem().toString())%400==0)&&thang.equals("2"))
        {
            cbbNgay1.setModel(cbbmodel);
            for (int i = 1; i < 30; i++) {
                cbbNgay1.addItem(String.valueOf(i));
            }
            if (Integer.valueOf(thanght) < 30) {
                cbbNgay1.setSelectedItem(thanght);
            }
        }
        else {
            cbbNgay1.setModel(cbbmodel);
            for (int i = 1; i < 29; i++) {
                cbbNgay1.addItem(String.valueOf(i));
            }
            if (Integer.valueOf(thanght) < 29) {
                cbbNgay1.setSelectedItem(thanght);
            }
        }
        //Show();
    }//GEN-LAST:event_cbbThang1ItemStateChanged

    private void cbbNam1ItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_cbbNam1ItemStateChanged
        // TODO add your handling code here:
          String thang = cbbThang1.getSelectedItem().toString();
        DefaultComboBoxModel cbbmodel = new DefaultComboBoxModel();
        String thanght;
        if (tam == 0) {
            thanght = "0";
        } else {
            thanght = cbbNgay1.getSelectedItem().toString();
        }
        tam = 1;

        if (thang.equals("4") || thang.equals("6") || thang.equals("9") || thang.equals("11")) {
            cbbNgay1.setModel(cbbmodel);
            for (int i = 1; i < 31; i++) {
                cbbNgay1.addItem(String.valueOf(i));
            }
            if (Integer.valueOf(thanght) < 31) {
                cbbNgay1.setSelectedItem(thanght);
            }
        } else if (thang.equals("1") || thang.equals("3") || thang.equals("5")
            || thang.equals("7") || thang.equals("8") || thang.equals("12") || thang.equals("10")) {

            cbbNgay1.setModel(cbbmodel);
            for (int i = 1; i < 32; i++) {
                cbbNgay1.addItem(String.valueOf(i));
            }
            if (Integer.valueOf(thanght) < 32) {
                cbbNgay1.setSelectedItem(thanght);
            }
        }
        else if((Integer.parseInt(cbbNam1.getSelectedItem().toString())%4==0
                &&(Integer.parseInt(cbbNam1.getSelectedItem().toString())%100!=0)
                ||Integer.parseInt(cbbNam1.getSelectedItem().toString())%400==0)&&thang.equals("2"))
        {
            cbbNgay1.setModel(cbbmodel);
            for (int i = 1; i < 30; i++) {
                cbbNgay1.addItem(String.valueOf(i));
            }
            if (Integer.valueOf(thanght) < 30) {
                cbbNgay1.setSelectedItem(thanght);
            }
        }
        else {
            cbbNgay1.setModel(cbbmodel);
            for (int i = 1; i < 29; i++) {
                cbbNgay1.addItem(String.valueOf(i));
            }
            if (Integer.valueOf(thanght) < 29) {
                cbbNgay1.setSelectedItem(thanght);
            }
        }
        //Show();
    }//GEN-LAST:event_cbbNam1ItemStateChanged

    private void cbbThang2ItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_cbbThang2ItemStateChanged
        // TODO add your handling code here:
        String thang = cbbThang2.getSelectedItem().toString();
        DefaultComboBoxModel cbbmodel = new DefaultComboBoxModel();
        String thanght;
        if (tam == 0) {
            thanght = "0";
        } else {
            thanght = cbbNgay2.getSelectedItem().toString();
        }
        tam = 1;

        if (thang.equals("4") || thang.equals("6") || thang.equals("9") || thang.equals("11")) {
            cbbNgay2.setModel(cbbmodel);
            for (int i = 1; i < 31; i++) {
                cbbNgay2.addItem(String.valueOf(i));
            }
            if (Integer.valueOf(thanght) < 31) {
                cbbNgay2.setSelectedItem(thanght);
            }
        } else if (thang.equals("1") || thang.equals("3") || thang.equals("5")
            || thang.equals("7") || thang.equals("8") || thang.equals("12") || thang.equals("10")) {

            cbbNgay2.setModel(cbbmodel);
            for (int i = 1; i < 32; i++) {
                cbbNgay2.addItem(String.valueOf(i));
            }
            if (Integer.valueOf(thanght) < 32) {
                cbbNgay2.setSelectedItem(thanght);
            }
        }
        else if((Integer.parseInt(cbbNam1.getSelectedItem().toString())%4==0
                &&(Integer.parseInt(cbbNam1.getSelectedItem().toString())%100!=0)
                ||Integer.parseInt(cbbNam1.getSelectedItem().toString())%400==0)&&thang.equals("2"))
        {
            cbbNgay2.setModel(cbbmodel);
            for (int i = 1; i < 30; i++) {
                cbbNgay2.addItem(String.valueOf(i));
            }
            if (Integer.valueOf(thanght) < 30) {
                cbbNgay2.setSelectedItem(thanght);
            }
        }
        else {
            cbbNgay2.setModel(cbbmodel);
            for (int i = 1; i < 29; i++) {
                cbbNgay2.addItem(String.valueOf(i));
            }
            if (Integer.valueOf(thanght) < 29) {
                cbbNgay2.setSelectedItem(thanght);
            }
        }
        //Show();
    }//GEN-LAST:event_cbbThang2ItemStateChanged

    private void cbbNam2ItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_cbbNam2ItemStateChanged
        // TODO add your handling code here:
        String thang = cbbThang2.getSelectedItem().toString();
        DefaultComboBoxModel cbbmodel = new DefaultComboBoxModel();
        String thanght;
        if (tam == 0) {
            thanght = "0";
        } else {
            thanght = cbbNgay2.getSelectedItem().toString();
        }
        tam = 1;

        if (thang.equals("4") || thang.equals("6") || thang.equals("9") || thang.equals("11")) {
            cbbNgay2.setModel(cbbmodel);
            for (int i = 1; i < 31; i++) {
                cbbNgay2.addItem(String.valueOf(i));
            }
            if (Integer.valueOf(thanght) < 31) {
                cbbNgay2.setSelectedItem(thanght);
            }
        } else if (thang.equals("1") || thang.equals("3") || thang.equals("5")
            || thang.equals("7") || thang.equals("8") || thang.equals("12") || thang.equals("10")) {

            cbbNgay2.setModel(cbbmodel);
            for (int i = 1; i < 32; i++) {
                cbbNgay2.addItem(String.valueOf(i));
            }
            if (Integer.valueOf(thanght) < 32) {
                cbbNgay2.setSelectedItem(thanght);
            }
        }
        else if((Integer.parseInt(cbbNam1.getSelectedItem().toString())%4==0
                &&(Integer.parseInt(cbbNam1.getSelectedItem().toString())%100!=0)
                ||Integer.parseInt(cbbNam1.getSelectedItem().toString())%400==0)&&thang.equals("2"))
        {
            cbbNgay2.setModel(cbbmodel);
            for (int i = 1; i < 30; i++) {
                cbbNgay2.addItem(String.valueOf(i));
            }
            if (Integer.valueOf(thanght) < 30) {
                cbbNgay2.setSelectedItem(thanght);
            }
        }
        else {
            cbbNgay2.setModel(cbbmodel);
            for (int i = 1; i < 29; i++) {
                cbbNgay2.addItem(String.valueOf(i));
            }
            if (Integer.valueOf(thanght) < 29) {
                cbbNgay2.setSelectedItem(thanght);
            }
        }
        //Show();
    }//GEN-LAST:event_cbbNam2ItemStateChanged

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
        // TODO add your handling code here:
        String Ngay1,Thang1,Nam1,Ngay2,Thang2,Nam2;
        Ngay1 = cbbNgay1.getSelectedItem().toString();
        if(Ngay1.length()==1)
        {
            Ngay1 = "0"+Ngay1;
        }
        Ngay2 = cbbNgay2.getSelectedItem().toString();
        if(Ngay2.length()==1)
        {
            Ngay2 = "0"+Ngay2;
        }
        Thang1 = cbbThang1.getSelectedItem().toString();
        Thang2 = cbbThang2.getSelectedItem().toString();
        Nam1 = cbbNam1.getSelectedItem().toString();
        Nam2 = cbbNam2.getSelectedItem().toString();
        
        String NgayNho = Nam1 + "-" + Thang1 + "-" + Ngay1;
        String NgayLon = Nam2 + "-" + Thang2 + "-" + Ngay2;
        
        Calendar c1 = Calendar.getInstance();
        c1.setTime(Date.valueOf(NgayNho));
        Calendar c2 = Calendar.getInstance();
        c2.setTime(Date.valueOf(NgayLon));
        
        if(c2.before(c1))
        {
            ThongBao("Chọn giai đoạn xem sai quy định,Ngày phía sau phải lớn hơn ngày phía trước", "Thông báo", 2);
        }
        else
        {
            String cautruyvan = " and NgayLapHoaDon >= '"+NgayNho+"' "
                + "and NgayLapHoaDon <= '"+NgayLon+"'";
        
            System.out.println(cautruyvan);
            HienThongKeLoi(cautruyvan);
            HienThongKeLo(cautruyvan);
            txtNgayBatDau.setText(Ngay1+"-"+Thang1+"-"+Nam1);
            txtNgayKeThuc.setText(Ngay2+"-"+Thang2+"-"+Nam2);
            txtNgayBatDau1.setText(Ngay1+"-"+Thang1+"-"+Nam1);
            txtNgayKeThuc1.setText(Ngay2+"-"+Thang2+"-"+Nam2);
            SetChiTietLo(cautruyvan);
            SetChiTietLoi(cautruyvan);
            setTongPhiBaoHanh(cautruyvan);
            String ctv = "NgayNhan >= '"+NgayNho+"' and NgayNhan <= '"+NgayLon+"'";
            setChiPhi(ctv);
            String ctv1 = " and NgayBan >= '"+NgayNho+"' and NgayBan <='"+NgayLon+"'";
            
            LayThongKe(ctv1);
            
        }
    }//GEN-LAST:event_jButton1ActionPerformed

    private void btnOKActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnOKActionPerformed
        // TODO add your handling code here:
        
        
        
            long S = TongTien();
            System.out.println(S);
            try{
                long Dien = Long.valueOf(txtTienDien.getText());
                long Nuoc = Long.valueOf(txtTienNuoc.getText());
                long MatBang = Long.valueOf(txtTienMatBang.getText());
                long Inter = Long.valueOf(txtTienInternet.getText());
                long DienThoai = Long.valueOf(txtTienDienThoai.getText()); 

                long Tong = Dien + Nuoc + MatBang + Inter + DienThoai;
                System.out.println(Tong);
                String tr = currencyVN.format(Tong);
                txtChiPhiPhatSinhTK.setText(tr);

                S = S - Tong;
                System.out.println(S);
                String tr1 = currencyVN.format(S);
                txtTongTK.setText(tr1);

            }catch(NumberFormatException n)
            {
                ThongBao("Các chi phí là số", "Thông báo", 2);
            }
        
        
    }//GEN-LAST:event_btnOKActionPerformed

    private void btnXuatLoiActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnXuatLoiActionPerformed
        // TODO add your handling code here:
        XuatFileExcel(tblThongKeChiTiet);
    }//GEN-LAST:event_btnXuatLoiActionPerformed

    private void btnXuatLoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnXuatLoActionPerformed
        // TODO add your handling code here:
        XuatFileExcel(tblLo);
    }//GEN-LAST:event_btnXuatLoActionPerformed

    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
        // TODO add your handling code here:
        String NgayKTThongKe = GoiNgayThongKe();
        Calendar c1 = Calendar.getInstance();
        c1.setTime(Date.valueOf(NgayKTThongKe));
        
        String NgayBDTKMoi = txtNgayBatDau.getText();
        String strngayv, strthangv, strnamv;
        strngayv = NgayBDTKMoi.substring(0,2);
        strthangv = NgayBDTKMoi.substring(3,5);
        strnamv = NgayBDTKMoi.substring(6,10);
        
        String NgayMoi = strnamv +"-"+strthangv+"-"+ strngayv;
        Calendar c2 = Calendar.getInstance();
        c2.setTime(Date.valueOf(NgayMoi));
        
        if(c2.before(c1) == true)
        {
            ThongBao("Đợt thống kê trước kết thúc vào ngày '"+NgayKTThongKe+"'", "Thông báo", 1);
        }
        else if(txtChiPhiPhatSinhTK.getText().equals(""))
        {
            ThongBao("Vui lòng nhập các chi phí hàng tháng", "Thông báo", 2);
        }else
        {
            String Ngay1,Thang1,Nam1,Ngay2,Thang2,Nam2;
            Ngay1 = cbbNgay1.getSelectedItem().toString();
            if(Ngay1.length()==1)
            {
                Ngay1 ="0"+Ngay1;
            }
            Ngay2 = cbbNgay2.getSelectedItem().toString();
            if(Ngay2.length()==1)
            {
                Ngay2 ="0"+Ngay2;
            }
            Thang1 = cbbThang1.getSelectedItem().toString();
            Thang2 = cbbThang2.getSelectedItem().toString();
            Nam1 = cbbNam1.getSelectedItem().toString();
            Nam2 = cbbNam2.getSelectedItem().toString();

            String NgayNho = Nam1 + "-" + Thang1 + "-" + Ngay1;
            String NgayLon = Nam2 + "-" + Thang2 + "-" + Ngay2;

                       

            String cautruyvan = "select sum(HoaDon.TongTien) as TongTien ,sum(HoaDon.TongGoc) as TongGoc, "
                    + "sum(ChiTietHoaDon.PhiBaoHanh) as PhiBaoHanh "
                                + "from HoaDon,SanPham,ChiTietHoaDon "
                                + "where SanPham.MaSanPham = ChiTietHoaDon.MaSanPham "
                                + "and HoaDon.MaHoaDon = ChiTietHoaDon.MaHoaDon "
                                + "and SanPham.GiaNhap < (ChiTietHoaDon.TongTien - ChiTietHoaDon.PhiBaoHanh) "
                                + "and NgayLapHoaDon >= '"+NgayNho+"' "
                                + "and NgayLapHoaDon <= '"+NgayLon+"'";
            System.out.println(cautruyvan);
            ResultSet rs =  cnn.ExcuteQueryGetTable(cautruyvan);
            try 
            {
                while(rs.next())
                {
                    long TongDoanhLoi = rs.getLong("TongTien");               
                    long TongGocLoi = rs.getLong("TongGoc");          
                    long LoiNhuan = TongDoanhLoi - TongGocLoi;
                    long PhiBaoHanhLoi = rs.getLong("PhiBaoHanh");
                    String cautruyvan1 = "select sum(HoaDon.TongTien) as TongTien ,"
                            + "sum(HoaDon.TongGoc) as TongGoc,sum(ChiTietHoaDon.PhiBaoHanh) as PhiBaoHanh "
                                        + "from HoaDon,SanPham,ChiTietHoaDon "
                                        + "where SanPham.MaSanPham = ChiTietHoaDon.MaSanPham "
                                        + "and HoaDon.MaHoaDon = ChiTietHoaDon.MaHoaDon "
                                        + "and SanPham.GiaNhap > (ChiTietHoaDon.TongTien - ChiTietHoaDon.PhiBaoHanh) "
                                        + " and NgayLapHoaDon >= '"+NgayNho+"' "
                                        + "and NgayLapHoaDon <= '"+NgayLon+"'";
                    System.out.println(cautruyvan);
                    ResultSet rs1 =  cnn.ExcuteQueryGetTable(cautruyvan1);
                    try 
                    {
                        while(rs1.next())
                        {
                            Long TongDoanhThuLo = rs1.getLong("TongTien");                        
                            Long TongGocLo = rs1.getLong("TongGoc");                        
                            Long TongLo = TongDoanhThuLo - TongGocLo;                       
                            Long PhiBaoHanhLo = rs1.getLong("PhiBaoHanh");
                            String cautruyvan2 = "select sum(LuongNhanVien.TongLuong) as Luong "
                                                + "from LuongNhanVien "
                                                + " where NgayNhan >= '"+NgayNho+"' "
                                                + "and NgayNhan <= '"+NgayLon+"'";
                            ResultSet rs2 = cnn.ExcuteQueryGetTable(cautruyvan2);
                            try 
                            {
                                while(rs2.next())
                                {
                                    long Luong = rs2.getLong("Luong");
                                    long Dien = Long.valueOf(txtTienDien.getText());
                                    long Nuoc = Long.valueOf(txtTienNuoc.getText());
                                    long MatBang = Long.valueOf(txtTienMatBang.getText());
                                    long Inter = Long.valueOf(txtTienInternet.getText());
                                    long DienThoai = Long.valueOf(txtTienDienThoai.getText()); 

                                    long TongChiPhiHangThang = Dien + Nuoc + MatBang + Inter + DienThoai;
                                    
                                    long TongPhiBaoHanh = PhiBaoHanhLo + PhiBaoHanhLoi;
                                    
                                    String NgayBDTK = txtNgayBatDau.getText();
                                    String strngay, strthang, strnam;
                                    strngay = NgayBDTK.substring(0,2);
                                    strthang = NgayBDTK.substring(3,5);
                                    strnam = NgayBDTK.substring(6,10);
                                    String NgayA = strnam+"-"+strthang+"-"+strngay;
                                    
                                    
                                    String NgayKTTK = txtNgayKeThuc.getText();
                                    String strngay1, strthang1, strnam1;
                                    strngay1 = NgayKTTK.substring(0,2);
                                    strthang1 = NgayKTTK.substring(3,5);
                                    strnam1 = NgayKTTK.substring(6,10);
                                    String NgayB = strnam1+"-"+strthang1+"-"+strngay1;
                                    
                                    String ctv = "Insert into ThongKe(NgayBDThongKe,NgayKTThongKe,LoiNhuan,ThuaLo,"
                                            + "PhiBaoHanh,LuongNhanVien,ChiPhiPhatSinh) "
                                                        + "values('"+NgayA+"','"+NgayB+"',"+String.valueOf(LoiNhuan)+","
                                                        + ""+String.valueOf(TongLo)+","+String.valueOf(TongPhiBaoHanh)+","
                                            + ""+String.valueOf(Luong)+","+String.valueOf(TongChiPhiHangThang)+")";
                                    cnn.ExcuteQueryUpdateDB(ctv);
                                    System.out.println(ctv);
                                    
                                    String ctv6 = "SELECT TOP 1 * FROM ThongKe ORDER BY MaThongKe DESC";
                                    ResultSet rs6 = cnn.ExcuteQueryGetTable(ctv6);
                                    try 
                                    {
                                        while(rs6.next())
                                        {
                                            String MaThongKe = rs6.getString("MaThongKe");
                                            
                                            String ctv1 = "Insert into ThongKeSinhLoi(MaThongKe,TongDoanhThu,TongVonBanDau,"
                                                    + "LoiNhuan,TongPhiBaoHanh) "
                                                    + "values("+MaThongKe+","+String.valueOf(TongDoanhLoi)+","
                                                    + ""+String.valueOf(TongGocLoi)+","
                                                    + ""+String.valueOf(LoiNhuan)+","
                                                    + ""+String.valueOf(PhiBaoHanhLoi)+")";
                                            cnn.ExcuteQueryUpdateDB(ctv1);
                                            System.out.println(ctv1);
                                            String ctv2 = "Insert into ThongKeKhongSinhLoi(MaThongKe,TongDoanhThu,TongVonBanDau,"
                                                    + "ThuaLo,TongPhiBaoHanh) "
                                                    + "values("+MaThongKe+","+String.valueOf(TongDoanhThuLo)+","
                                                    + ""+String.valueOf(TongGocLo)+","
                                                    + ""+String.valueOf(TongLo)+","+String.valueOf(PhiBaoHanhLo)+")";
                                            cnn.ExcuteQueryUpdateDB(ctv2);
                                            System.out.println(ctv2);
                                            String ctv3 = "Insert into ChiPhiThang(MaThongKe,TienDien,TienNuoc,TienThueMatBang,"
                                                    + "TienInternet,TienDienThoai) "
                                                    + "values("+MaThongKe+","+txtTienDien.getText()+","+txtTienNuoc.getText()+","
                                                    + ""+txtTienMatBang.getText()+","+txtTienInternet.getText()+","
                                                    + ""+txtTienDienThoai.getText()+")";
                                            cnn.ExcuteQueryUpdateDB(ctv3);
                                            System.out.println(ctv3);

                                            ThongBao("Đã lưu thành công", "Thông báo", 1);
                                        }
                                    } catch (SQLException ex) 
                                    {
                                        Logger.getLogger(ChiTietThongKeJPanel.class.getName()).log(Level.SEVERE, null, ex);
                                    }
                                }
                            } catch (SQLException ex) 
                            {
                                Logger.getLogger(ChiTietThongKeJPanel.class.getName()).log(Level.SEVERE, null, ex);
                            }       
                        }       
                    } catch (SQLException ex) 
                    {
                        Logger.getLogger(ChiTietThongKeJPanel.class.getName()).log(Level.SEVERE, null, ex);
                    }
                 }       
            } catch (SQLException ex) 
            {
                Logger.getLogger(ChiTietThongKeJPanel.class.getName()).log(Level.SEVERE, null, ex);
            }           
        }                    
    }//GEN-LAST:event_jButton2ActionPerformed

    private void btnThemVonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThemVonActionPerformed
        // TODO add your handling code here:
        String VonThem,GhiChu,Ngay;
        VonThem = txtVonThem.getText();
        GhiChu = txtGhiChuVonThem.getText();
        
        String cautruyvan = "insert into Von(VonThem,GhiChu) values("+VonThem+",'"+GhiChu+"')";
        cnn.ExcuteQueryUpdateDB(cautruyvan);
        String ctv = "select * from Von";
        ResultSet rs = cnn.ExcuteQueryGetTable(ctv);
        try {
            while(rs.next())
            {
                long Tong = rs.getLong("TongVon");
                Tong = Tong + Long.valueOf(VonThem);
                String ctv1 = "update Von set TongVon = "+String.valueOf(Tong)+"";
                cnn.ExcuteQueryUpdateDB(ctv1);
                
            }
        } catch (SQLException ex) {
            Logger.getLogger(ChiTietThongKeJPanel.class.getName()).log(Level.SEVERE, null, ex);
        }
        ThongBao("Thêm vốn thành công", "Thông báo", 1);
        HienVon();
    }//GEN-LAST:event_btnThemVonActionPerformed

    private void btnSuaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSuaActionPerformed
        // TODO add your handling code here:
        String GhiChu = txtGhiChuVonThem.getText();
        String ctv = "select * from Von where MaVon = " + txtMaVOn.getText();
        ResultSet rs = cnn.ExcuteQueryGetTable(ctv);
        try {
            while(rs.next())
            {
                long VonCu = rs.getLong("VonThem");
                long TongVon = rs.getLong("TongVon");
                String VonMoi = txtVonThem.getText();
                //Nếu vốn thêm cũ mà nhỏ hơn vốn sửa thì TongVon = TongVon + (VonMoi - VonCu)
                if(VonCu < Long.valueOf(VonMoi))
                {
                    
                    TongVon = TongVon + (Long.valueOf(VonMoi) - VonCu);
                    String ctv1 = "update Von set VonThem = "+VonMoi+",TongVon = "+String.valueOf(TongVon)+",GhiChu = '"+GhiChu+"'";
                    cnn.ExcuteQueryUpdateDB(ctv1);
                }
                //Nếu vốn thêm cũ mà lớn hơn vốn sửa thì TongVon = TongVon - (VonCu - VonMoi)
                else if(VonCu > Long.valueOf(VonMoi))
                {
                    TongVon = TongVon - (VonCu - Long.valueOf(VonMoi));
                    String ctv1 = "update Von set VonThem = "+VonMoi+",TongVon = "+String.valueOf(TongVon)+",GhiChu = '"+GhiChu+"'";
                    cnn.ExcuteQueryUpdateDB(ctv1);
                }else
                {
                    ThongBao("Vốn bạn sửa không có sự thay đổi", "Thông báo", 2);
                    String ctv2 = "update Von set GhiChu = '"+GhiChu+"'";
                    cnn.ExcuteQueryUpdateDB(ctv2);
                }
            }
        } catch (SQLException ex) {
            Logger.getLogger(ChiTietThongKeJPanel.class.getName()).log(Level.SEVERE, null, ex);
        }
        ThongBao("Sửa thành công", "2", 1);
        HienVon();
    }//GEN-LAST:event_btnSuaActionPerformed

    private void tblGiaDoanMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblGiaDoanMouseClicked
        // TODO add your handling code here:
        int viTriDongVuaBam = tblGiaDoan.getSelectedRow();       
        String ngaybd = tblGiaDoan.getValueAt(viTriDongVuaBam, 1).toString();
        String strngayv, strthangv, strnamv;
        strngayv = ngaybd.substring(0,2);
        strthangv = ngaybd.substring(3,5);
        strnamv = ngaybd.substring(6, 10);
        String ngaybatdau = strnamv + "-" + strthangv +"-"+strngayv;
        System.out.println(ngaybatdau);
        LayDuLieuQuyetToan(ngaybatdau);
    }//GEN-LAST:event_tblGiaDoanMouseClicked

    private void btnThuHoiVonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThuHoiVonActionPerformed
        // TODO add your handling code here:
        String cctv = "SELECT TOP 1 * FROM ThongKe ORDER BY MaThongKe DESC";
        ResultSet rss = cnn.ExcuteQueryGetTable(cctv);
        int TrangThai = 0;
        try {
            while(rss.next())
            {
                TrangThai = rss.getInt("TrangThai");
            }
        } catch (SQLException ex) {
            Logger.getLogger(ChiTietThongKeJPanel.class.getName()).log(Level.SEVERE, null, ex);
        }
        if(TrangThai == 1)
        {
            ThongBao("Đã thu hồi Vốn trong giai đoạn thống kê này", "Thoong báo", 1);
        }
        else{
            int bien = JOptionPane.showConfirmDialog(null, "Bạn có muốn thu hồi vốn?","Thông báo",JOptionPane.YES_NO_OPTION);
            if(bien == JOptionPane.YES_OPTION)
            {
                ThuHoiVon();
                HienVon();
            }
        }
        
        
    }//GEN-LAST:event_btnThuHoiVonActionPerformed

    private void jButton3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton3ActionPerformed
        // TODO add your handling code here:
        XuatFileExcel(tblChiTietBan);
    }//GEN-LAST:event_jButton3ActionPerformed
    public void HiencbbNgayThangNam()
    {
        for(int i = 1;i<32;i++)
        {
            cbbNgay1.addItem(String.valueOf(i));
            cbbNgay2.addItem(String.valueOf(i));
        }
        for (int i = 1; i < 13; i++)
        {
            cbbThang1.addItem(String.valueOf(i));
            cbbThang2.addItem(String.valueOf(i));
        }
        for (int i = year; i > 2000; i--)
        {
            cbbNam1.addItem(String.valueOf(i));
            cbbNam2.addItem(String.valueOf(i));
        }
        cbbNgay1.setSelectedItem(String.valueOf(day));
        cbbThang1.setSelectedItem(String.valueOf(month-1));
        cbbNam1.setSelectedItem(String.valueOf(year));
        
        cbbNgay2.setSelectedItem(String.valueOf(day));
        cbbThang2.setSelectedItem(String.valueOf(month));
        cbbNam2.setSelectedItem(String.valueOf(year));
    }
    
    public void Show()
    {
        String Ngay1,Thang1,Nam1,Ngay2,Thang2,Nam2;
        Ngay1 = cbbNgay1.getSelectedItem().toString();
        Ngay2 = cbbNgay2.getSelectedItem().toString();
        Thang1 = cbbThang1.getSelectedItem().toString();
        Thang2 = cbbThang2.getSelectedItem().toString();
        Nam1 = cbbNam1.getSelectedItem().toString();
        Nam2 = cbbNam2.getSelectedItem().toString();
        
        String NgayNho = Nam1 + "-" + Thang1 + "-" + Ngay1;
        String NgayLon = Nam2 + "-" + Thang2 + "-" + Ngay2;
        
        
            String cautruyvan = " and NgayLapHoaDon >= '"+NgayNho+"' "
                + "and NgayLapHoaDon <= '"+NgayLon+"'";
        
            System.out.println(cautruyvan);
            HienThongKeLoi(cautruyvan);
            HienThongKeLo(cautruyvan);
            
            String ctv = " and NgayBan >= '"+NgayNho+"' and NgayBan <='"+NgayLon+"'";
            System.out.println(ctv);
            LayThongKe(ctv);
    }
    
    public void HienThongKeLoi(String wheredk)
    {
        String cautruyvan = "select HoaDon.NgayLapHoaDon,HoaDon.TongTien,KhachHang.TenKhachHang,SanPham.TenSanPham "
                + "from SanPham,HoaDon,ChiTietHoaDon,KhachHang "
                + "where SanPham.MaSanPham = ChiTietHoaDon.MaSanPham "
                + "and HoaDon.TongTien >= SanPham.GiaNhap "
                + "and HoaDon.MaHoaDon = ChiTietHoaDon.MaHoaDon "
                + "and HoaDon.MaKhachHang = KhachHang.MaKhachHang"               
                + " " + wheredk;
        ResultSet rs = cnn.ExcuteQueryGetTable(cautruyvan);
        Object[] obj = new Object[]{"STT", "Tên Sản Phẩm","Ngày Bán","Tên Khách Hàng","Tổng Tiền"};
        DefaultTableModel tableModel = new DefaultTableModel(obj, 0);
        tblThongKeChiTiet.setModel(tableModel);
        int c = 0;
        try {
            while (rs.next()) {
                Object[] item = new Object[5];
                c++;
                item[0] = c;
                item[1] = rs.getString("TenSanPham");
                item[2] = rs.getString("NgayLapHoaDon");
                item[3] = rs.getString("TenKhachHang");
                long TT = rs.getLong("TongTien");
                String str = currencyVN.format(TT);
                item[4] = str;
                tableModel.addRow(item);
            }
        } catch (SQLException ex) {
            System.out.println(ex.toString());
        }
    }
    
    //-----------------------------------------------------------------------------------
    public void HienThongKeLo(String wheredk)
    {
        String cautruyvan = "select HoaDon.NgayLapHoaDon,HoaDon.TongTien,KhachHang.TenKhachHang,SanPham.TenSanPham "
                + "from SanPham,HoaDon,ChiTietHoaDon,KhachHang "
                + "where SanPham.MaSanPham = ChiTietHoaDon.MaSanPham "
                + "and HoaDon.TongTien < SanPham.GiaNhap "
                + "and HoaDon.MaHoaDon = ChiTietHoaDon.MaHoaDon "
                + "and HoaDon.MaKhachHang = KhachHang.MaKhachHang"               
                + " " + wheredk;
        ResultSet rs = cnn.ExcuteQueryGetTable(cautruyvan);
        Object[] obj = new Object[]{"STT", "Tên Sản Phẩm","Ngày Bán","Tên Khách Hàng","Tổng Tiền"};
        DefaultTableModel tableModel = new DefaultTableModel(obj, 0);
        tblLo.setModel(tableModel);
        int c = 0;
        try {
            while (rs.next()) {
                Object[] item = new Object[5];
                c++;
                item[0] = c;
                item[1] = rs.getString("TenSanPham");
                item[2] = rs.getString("NgayLapHoaDon");
                item[3] = rs.getString("TenKhachHang");
                long TT = rs.getLong("TongTien");
                String str = currencyVN.format(TT);
                item[4] = str;
                tableModel.addRow(item);
            }
        } catch (SQLException ex) {
            System.out.println(ex.toString());
        }
    }
    //-----------------------------------------------------------------------------------
    public void SetChiTietLo(String DK)
    {
        String cautruyvan = "select sum(HoaDon.TongTien) as TongTien ,sum(HoaDon.TongGoc) as TongGoc,sum(ChiTietHoaDon.PhiBaoHanh) as PhiBaoHanh "
                + "from HoaDon,SanPham,ChiTietHoaDon "
                + "where SanPham.MaSanPham = ChiTietHoaDon.MaSanPham "
                + "and HoaDon.MaHoaDon = ChiTietHoaDon.MaHoaDon "
                + "and SanPham.GiaNhap > (ChiTietHoaDon.TongTien - ChiTietHoaDon.PhiBaoHanh) "
                + " " + DK;
        System.out.println(cautruyvan);
        ResultSet rs =  cnn.ExcuteQueryGetTable(cautruyvan);
        try {
            while(rs.next())
            {
                Long TongDoanhThuLo = rs.getLong("TongTien");
                String T1 = currencyVN.format(TongDoanhThuLo);
                txtTongDoanhThuLo.setText(T1);
                
                Long TongGocLo = rs.getLong("TongGoc");
                String T2 = currencyVN.format(TongGocLo);
                txtTongVoLo.setText(T2);
                
                Long TongLo = TongDoanhThuLo - TongGocLo;
                String T3 = currencyVN.format(TongLo);
                txtLo.setText(T3);
                txtThuaLoTK.setText(T3);
                
                Long PhiBaoHanh = rs.getLong("PhiBaoHanh");
                String T4 = currencyVN.format(PhiBaoHanh);
                txtPhiBaoHanhLo.setText(T4);
            }       
        } catch (SQLException ex) {
            Logger.getLogger(ChiTietThongKeJPanel.class.getName()).log(Level.SEVERE, null, ex);
        }
            
    }
    
    
    public void SetChiTietLoi(String DK)
    {
        String cautruyvan = "select sum(HoaDon.TongTien) as TongTien ,sum(HoaDon.TongGoc) as TongGoc, sum(ChiTietHoaDon.PhiBaoHanh) as PhiBaoHanh "
                + "from HoaDon,SanPham,ChiTietHoaDon "
                + "where SanPham.MaSanPham = ChiTietHoaDon.MaSanPham "
                + "and HoaDon.MaHoaDon = ChiTietHoaDon.MaHoaDon "
                + "and SanPham.GiaNhap < (ChiTietHoaDon.TongTien - ChiTietHoaDon.PhiBaoHanh) "
                + " " + DK;
        System.out.println(cautruyvan);
        ResultSet rs =  cnn.ExcuteQueryGetTable(cautruyvan);
        try {
            while(rs.next())
            {
                Long TongDoanhThuLo = rs.getLong("TongTien");
                String T1 = currencyVN.format(TongDoanhThuLo);
                txtTongDoanhThuLoi.setText(T1);
                
                Long TongGocLo = rs.getLong("TongGoc");
                String T2 = currencyVN.format(TongGocLo);
                txtTongVonBanDauLoi.setText(T2);
                
                Long TongLo = TongDoanhThuLo - TongGocLo;
                String T3 = currencyVN.format(TongLo);
                txtLoiNhuan.setText(T3);
                txtLoiNhuanTK.setText(T3);
                
                Long PhiBaoHanh = rs.getLong("PhiBaoHanh");
                String T4 = currencyVN.format(PhiBaoHanh);
                txtPhiBaoHanh.setText(T4);
            }       
        } catch (SQLException ex) {
            Logger.getLogger(ChiTietThongKeJPanel.class.getName()).log(Level.SEVERE, null, ex);
        }
            
    }
    public void setChiPhi(String DK)
    {
        String cautruyvan = "select sum(LuongNhanVien.TongLuong) as Luong "
                + "from LuongNhanVien "
                + "where " + DK;
        ResultSet rs = cnn.ExcuteQueryGetTable(cautruyvan);
        try {
            while(rs.next())
            {
                long Luong = rs.getLong("Luong");
                String str = currencyVN.format(Luong);
                txtLuongNVTK.setText(str);
            }
        } catch (SQLException ex) {
            Logger.getLogger(ChiTietThongKeJPanel.class.getName()).log(Level.SEVERE, null, ex);
        }       
    }
    public void setTongPhiBaoHanh(String DK)
    {
        String cautruyvan = "select sum(ChiTietHoaDon.PhiBaoHanh) as PhiBaoHanh "
                + "from HoaDon,SanPham,ChiTietHoaDon "
                + "where SanPham.MaSanPham = ChiTietHoaDon.MaSanPham "
                + "and HoaDon.MaHoaDon = ChiTietHoaDon.MaHoaDon "
                + " "+DK;
        ResultSet rs = cnn.ExcuteQueryGetTable(cautruyvan);
        try {
            while(rs.next())
            {
                long Phi = rs.getLong("PhiBaoHanh");
                String tr = currencyVN.format(Phi);
                txtPhiBaoHanhTK.setText(tr);
            }
        } catch (SQLException ex) {
            Logger.getLogger(ChiTietThongKeJPanel.class.getName()).log(Level.SEVERE, null, ex);
        }
    }
    //-----------------------------------------------------------------------------------
    public String GetCbbSelected(JComboBox cbb) 
    {
        Object[] obj = cbb.getSelectedObjects();
        displayvalueModel item = (displayvalueModel) obj[0];
        return item.displayvalue.toString();

    }
    //-------------------------------------------------------------------
    public void ThongBao(String noiDungThongBao, String tieuDeThongBao, int icon) 
    {
        JOptionPane.showMessageDialog(new JFrame(), noiDungThongBao,
                tieuDeThongBao, icon);
    }
    //-------------------------------------------------------------------
    public void setSelectedCombobox(String cbbselected, JComboBox cbb) 
    {
        for (int i = 0; i < cbb.getItemCount(); i++) {
            Object obj = cbb.getItemAt(i);
            if (obj != null) {
                displayvalueModel m = (displayvalueModel) obj;
                if (cbbselected.trim().equals(m.displayMember)) {
                    cbb.setSelectedItem(m);
                }
            }
        }
    }
    public DefaultComboBoxModel LayDuLieucbb(String bang, String Ten, String Ma) 
    {
        String cautruyvan = "select *from " + bang;
        ResultSet rs = cnn.ExcuteQueryGetTable(cautruyvan);
        DefaultComboBoxModel cbbmodel = new DefaultComboBoxModel();
        try {
            while (rs.next()) {
                displayvalueModel valueModel = new displayvalueModel(rs.getString(Ten), rs.getString(Ma));
                cbbmodel.addElement(valueModel);
            }
        } catch (SQLException ex) {
            System.out.println(ex.toString());
        }
        return cbbmodel;
    }
    public long TongTien()
    {
        String Ngay1,Thang1,Nam1,Ngay2,Thang2,Nam2;
        Ngay1 = cbbNgay1.getSelectedItem().toString();
        Ngay2 = cbbNgay2.getSelectedItem().toString();
        Thang1 = cbbThang1.getSelectedItem().toString();
        Thang2 = cbbThang2.getSelectedItem().toString();
        Nam1 = cbbNam1.getSelectedItem().toString();
        Nam2 = cbbNam2.getSelectedItem().toString();
        
        String NgayNho = Nam1 + "-" + Thang1 + "-" + Ngay1;
        String NgayLon = Nam2 + "-" + Thang2 + "-" + Ngay2;
        
        Calendar c1 = Calendar.getInstance();
        c1.setTime(Date.valueOf(NgayNho));
        Calendar c2 = Calendar.getInstance();
        c2.setTime(Date.valueOf(NgayLon));
        long Tongall =0;
        String cautruyvan = "select sum(HoaDon.TongTien) as TongTien ,sum(HoaDon.TongGoc) as TongGoc, sum(ChiTietHoaDon.PhiBaoHanh) as PhiBaoHanh "
                + "from HoaDon,SanPham,ChiTietHoaDon "
                + "where SanPham.MaSanPham = ChiTietHoaDon.MaSanPham "
                + "and HoaDon.MaHoaDon = ChiTietHoaDon.MaHoaDon "
                + "and SanPham.GiaNhap < (ChiTietHoaDon.TongTien - ChiTietHoaDon.PhiBaoHanh) "
                + "and NgayLapHoaDon >= '"+NgayNho+"' "
                + "and NgayLapHoaDon <= '"+NgayLon+"'";
        System.out.println(cautruyvan);
        ResultSet rs =  cnn.ExcuteQueryGetTable(cautruyvan);
        try {
            while(rs.next())
            {
                long TongDoanhLoi = rs.getLong("TongTien");               
                long TongGocLoi = rs.getLong("TongGoc");          
                long LoiNhuan = TongDoanhLoi - TongGocLoi;
                long PhiBaoHanhLoi = rs.getLong("PhiBaoHanh");
                String cautruyvan1 = "select sum(HoaDon.TongTien) as TongTien ,sum(HoaDon.TongGoc) as TongGoc,sum(ChiTietHoaDon.PhiBaoHanh) as PhiBaoHanh "
                        + "from HoaDon,SanPham,ChiTietHoaDon "
                        + "where SanPham.MaSanPham = ChiTietHoaDon.MaSanPham "
                        + "and HoaDon.MaHoaDon = ChiTietHoaDon.MaHoaDon "
                        + "and SanPham.GiaNhap > (ChiTietHoaDon.TongTien - ChiTietHoaDon.PhiBaoHanh) "
                        + " and NgayLapHoaDon >= '"+NgayNho+"' "
                        + "and NgayLapHoaDon <= '"+NgayLon+"'";
                System.out.println(cautruyvan);
                ResultSet rs1 =  cnn.ExcuteQueryGetTable(cautruyvan1);
                try {
                    while(rs1.next())
                    {
                        Long TongDoanhThuLo = rs1.getLong("TongTien");                        
                        Long TongGocLo = rs1.getLong("TongGoc");                        
                        Long TongLo = TongDoanhThuLo - TongGocLo;                       
                        Long PhiBaoHanhLo = rs1.getLong("PhiBaoHanh");
                        String cautruyvan2 = "select sum(LuongNhanVien.TongLuong) as Luong "
                                + "from LuongNhanVien "
                                + " where NgayNhan >= '"+NgayNho+"' "
                                + "and NgayNhan <= '"+NgayLon+"'";
                        ResultSet rs2 = cnn.ExcuteQueryGetTable(cautruyvan2);
                        try {
                            while(rs2.next())
                            {
                                long Luong = rs2.getLong("Luong");
                                Tongall = LoiNhuan + TongLo + PhiBaoHanhLo + PhiBaoHanhLoi -Luong;
                                
                            }
                        } catch (SQLException ex) {
                            Logger.getLogger(ChiTietThongKeJPanel.class.getName()).log(Level.SEVERE, null, ex);
                        }       
                                    }       
                } catch (SQLException ex) {
                    Logger.getLogger(ChiTietThongKeJPanel.class.getName()).log(Level.SEVERE, null, ex);
                }
            }       
        } catch (SQLException ex) {
            Logger.getLogger(ChiTietThongKeJPanel.class.getName()).log(Level.SEVERE, null, ex);
        }
        return (long) Tongall;
    }
    
    public void XuatFileExcel(JTable table)
    {
        FileOutputStream excelFOU = null;
        BufferedOutputStream excelBOU = null;
        XSSFWorkbook excelJTableExporter = null;
 
        //Choose Location For Saving Excel File
        JFileChooser excelFileChooser = new JFileChooser("F:\\Luu");
//        Change Dilog Box Title
        excelFileChooser.setDialogTitle("Save As");
    //Onliny filter files with these extensions "xls", "xlsx", "xlsm"
        FileNameExtensionFilter fnef = new FileNameExtensionFilter("EXCEL FILES", "xls", "xlsx", "xlsm");
        excelFileChooser.setFileFilter(fnef);
        DefaultTableModel model = (DefaultTableModel) table.getModel();
        int excelChooser = excelFileChooser.showSaveDialog(null);
 
        //Check if save button is clicked
        if (excelChooser == JFileChooser.APPROVE_OPTION) {
 
            try {
                //Import excel poi libraries to netbeans
                excelJTableExporter = new XSSFWorkbook();
                XSSFSheet excelSheet = excelJTableExporter.createSheet("JTable Sheet");
                
                //Loop to get jtable columns and rows
                for (int i = 0; i < model.getRowCount(); i++) {
                    XSSFRow excelRow = excelSheet.createRow(i);
                    for (int j = 0; j< model.getColumnCount(); j++) 
                    {
                        XSSFCell excelCell = excelRow.createCell(j); 
                        excelCell.setCellValue(model.getValueAt(i, j).toString());                     
                    }
                }   
                excelFOU = new FileOutputStream(excelFileChooser.getSelectedFile() + ".xlsx");
                excelBOU = new BufferedOutputStream(excelFOU);
                excelJTableExporter.write(excelBOU);
                JOptionPane.showMessageDialog(null, "Xuất file thành công!!!........");
            } catch (FileNotFoundException ex) {
                ex.printStackTrace();
            } catch (IOException ex) {
                ex.printStackTrace();
            } finally {
                try {
                    if (excelBOU != null) {
                        excelBOU.close();
                    }
                    if (excelFOU != null) {
                        excelFOU.close();
                    }
                    if (excelJTableExporter != null) {
                        excelJTableExporter.close();
                    }
                } catch (IOException ex) {
                    ex.printStackTrace();
                }
            }
 
        }
    }
    
    
    
    public void HienVon()
    {
        String cautruyvan = "select * from Von";
        ResultSet rs = cnn.ExcuteQueryGetTable(cautruyvan);
        Object[] obj = new Object[]{"Mã Vốn", "Vốn Thêm","Ngày Thêm","Tổng Vốn","Ghi Chú"};
        DefaultTableModel tableModel = new DefaultTableModel(obj, 0);
        tblVonThem.setModel(tableModel);
        try {
            while(rs.next())
            {
                Object[] item = new Object[5];    
                
                item[0] = rs.getInt("MaVon");
                long vonthem = rs.getLong("VonThem");
                String t = currencyVN.format(vonthem);
                item[1] = t;
                item[2] = rs.getString("NgayThem");
                long TT = rs.getLong("TongVon");
                String str = currencyVN.format(TT);
                item[3] = str;
                item[4] = rs.getString("GhiChu");
                tableModel.addRow(item);
            }
        } catch (SQLException ex) {
            Logger.getLogger(ChiTietThongKeJPanel.class.getName()).log(Level.SEVERE, null, ex);
        }
    }
    
    public void HienGiaiDoan()
    {
        String cautruyvan = "select * from ThongKe";
        ResultSet rs = cnn.ExcuteQueryGetTable(cautruyvan);
        Object[] obj = new Object[]{"STT","Ngày Bắt Đầu","Ngày Kết Thúc"};
        DefaultTableModel tableModel = new DefaultTableModel(obj, 0);
        tblGiaDoan.setModel(tableModel);
        int c =0;
        try {
            while(rs.next())
            {
                Object[] item = new Object[3];   
                c++;
                item[0] = c;
                Date ngaybd = rs.getDate("NgayBDThongKe");
                SimpleDateFormat formatter = new SimpleDateFormat("dd-MM-yyyy");
                String strDate = formatter.format(ngaybd);
                item[1] =  strDate;
                Date ngaykt = rs.getDate("NgayKTThongKe");
                String strDate1 = formatter.format(ngaykt);
                item[2] = strDate1;
                tableModel.addRow(item);
            }
        } catch (SQLException ex) {
            Logger.getLogger(ChiTietThongKeJPanel.class.getName()).log(Level.SEVERE, null, ex);
        }
    }
    public void LayDuLieuQuyetToan(String NgayBatDau)
    {       
        String cautruyvan = "select * from ThongKe where NgayBDThongKe = '"+ NgayBatDau+"'";
        ResultSet rs = cnn.ExcuteQueryGetTable(cautruyvan);
        Object[] obj = new Object[]{"Tổng Doanh Thu","Vốn Lỗ","Lương Nhân Viên","Chi Phí Tháng","Phí Bảo Hành"};
        DefaultTableModel tableModel = new DefaultTableModel(obj, 0);
        tblQuyetToan.setModel(tableModel);
        try {
            while(rs.next())
            {
                long TongLoi = 0;
                long TongLo = 0;
                String mathongke = rs.getString("MaThongKe");
                String ctv1 = "select * from ThongKeKhongSinhLoi where MaThongKe = "+mathongke;
                ResultSet rs1 = cnn.ExcuteQueryGetTable(ctv1);
                while(rs1.next())
                {
                    TongLo = rs1.getLong("TongDoanhThu");       
                }
                String ctv2 = "select * from ThongKeSinhLoi where MaThongKe = "+mathongke;
                ResultSet rs2 = cnn.ExcuteQueryGetTable(ctv2);
                while(rs2.next())
                {
                    TongLoi = rs2.getLong("TongDoanhThu");       
                }
                long DoanhThuTong = TongLoi + TongLo;
                String doanhthu = currencyVN.format(DoanhThuTong);
                Object[] item = new Object[5];   
                item[0] = doanhthu;
                long ThuaLo = rs.getLong("ThuaLo");
                String thualo = currencyVN.format(ThuaLo);
                item[1] = thualo;
                long LuongNV = rs.getLong("LuongNhanVien");
                String luongnv = currencyVN.format(LuongNV);
                item[2] = luongnv;
                long ChiPhi = rs.getLong("ChiPhiPhatSinh");
                String chiphi = currencyVN.format(ChiPhi);
                item[3] = chiphi;
                long BaoHanh = rs.getLong("PhiBaoHanh");
                String baohanh = currencyVN.format(BaoHanh);
                item[4] = baohanh;
                tableModel.addRow(item);
            }
        } catch (SQLException ex) {
            Logger.getLogger(ChiTietThongKeJPanel.class.getName()).log(Level.SEVERE, null, ex);
        }
    }
    
    public String GoiNgayThongKe()
    {
        String Ngay = "";
        String cautruyvan = "SELECT TOP 1 * FROM ThongKe ORDER BY MaThongKe DESC";
        ResultSet rs = cnn.ExcuteQueryGetTable(cautruyvan);
        try {
            while(rs.next())
            {
                Ngay = rs.getString("NgayKTThongKe");
            }
        } catch (SQLException ex) {
            Logger.getLogger(ChiTietThongKeJPanel.class.getName()).log(Level.SEVERE, null, ex);
        }
        return Ngay;
    }
    
    public String GoiMaThongKe()
    {
        String MaThongKe = "";
                
        String cctv = "SELECT TOP 1 * FROM ThongKe ORDER BY MaThongKe DESC";
        ResultSet rss = cnn.ExcuteQueryGetTable(cctv);
        try {
            while(rss.next())
            {
                MaThongKe = rss.getString("MaThongKe");
            }
        } catch (SQLException ex) {
            Logger.getLogger(ChiTietThongKeJPanel.class.getName()).log(Level.SEVERE, null, ex);
        }
        return MaThongKe;
    }
     
    public void ThuHoiVon()
    {       
        String MaThongKe = GoiMaThongKe();
        String cautruyvan = "select * from ThongKe where MaThongKe = "+ MaThongKe;
        ResultSet rs = cnn.ExcuteQueryGetTable(cautruyvan);       
        try {
            while(rs.next())
            {
                
                long TongVonBanDauLoi =0;
               
                long TongVonBanDauLo =0;
                String mathongke = rs.getString("MaThongKe");
                String ctv1 = "select * from ThongKeKhongSinhLoi where MaThongKe = "+mathongke;
                ResultSet rs1 = cnn.ExcuteQueryGetTable(ctv1);
                while(rs1.next())
                {
                   
                    TongVonBanDauLo = rs1.getLong("TongVonBanDau");
                }
                String ctv2 = "select * from ThongKeSinhLoi where MaThongKe = "+mathongke;
                ResultSet rs2 = cnn.ExcuteQueryGetTable(ctv2);
                while(rs2.next())
                {
                   
                    TongVonBanDauLoi = rs2.getLong("TongVonBanDau");
                }
                
                
                long VonBoRa = (TongVonBanDauLoi + TongVonBanDauLo);
                
                String MaVon = "";
                String TrangThai = "1";
                String cctv = "SELECT TOP 1 * FROM Von ORDER BY MaVon DESC";
                ResultSet rss = cnn.ExcuteQueryGetTable(cctv);
                while(rss.next())
                {
                    MaVon = rss.getString("MaVon");
                    long Von = rss.getLong("TongVon");
                    Von = Von + VonBoRa;
                    String update = "update Von set TongVon = "+String.valueOf(Von)+" where MaVon = "+MaVon;
                    cnn.ExcuteQueryUpdateDB(update);
                }               
                String ccc = "update ThongKe set TrangThai ="+TrangThai+" where MaThongKe = "+MaThongKe;
                cnn.ExcuteQueryUpdateDB(ccc);
                String ctvv = "insert into ThuHoiVon(MaVon,MaThongKe,VonThuHoi) "
                        + "values("+MaVon+","+MaThongKe+","+String.valueOf(VonBoRa)+")";
                cnn.ExcuteQueryUpdateDB(ctvv);
                ThongBao("Thu hồi vốn thành công", "Thông báo", 1);
                LayDuLieuVonThuHoi();
            }
        } catch (SQLException ex) {
            Logger.getLogger(ChiTietThongKeJPanel.class.getName()).log(Level.SEVERE, null, ex);
        }
    }
    
    public void LayDuLieuVonThuHoi()
    {
        String cautruyvan = "select * from ThuHoiVon";
        ResultSet rs = cnn.ExcuteQueryGetTable(cautruyvan);
        Object[] obj = new Object[]{"Mã Vốn","Mã Thống Kê","Vốn Thu Hồi","Ngày Thu Hồi"};
        DefaultTableModel tableModel = new DefaultTableModel(obj, 0);
        tblVonThuHoi.setModel(tableModel);
        try {
            while(rs.next())
            {
                Object[] item = new Object[4];   
                item[0] = rs.getInt("MaVon");
                
                item[1] = rs.getInt("MaThongKe");
                long LuongNV = rs.getLong("VonThuHoi");
                String luongnv = currencyVN.format(LuongNV);
                item[2] = luongnv;
                
                Date ngaybd = rs.getDate("NgayThuHoi");
                SimpleDateFormat formatter = new SimpleDateFormat("dd-MM-yyyy");
                String strDate = formatter.format(ngaybd);
                
                item[3] = strDate;
                
                tableModel.addRow(item);
            }
        } catch (SQLException ex) {
            Logger.getLogger(ChiTietThongKeJPanel.class.getName()).log(Level.SEVERE, null, ex);
        }
    }
    
    
    public void LayThongKe(String wheredk)
    {
        
        String cautruyvan ="select SanPham.TenSanPham, sum(ChiTietThongKe.SoLuongBan) as SoLuong,((SanPham.GiaNhap*SanPham.HeSo)*sum(ChiTietThongKe.SoLuongBan)) as TongTien "
                + "from ChiTietThongKe,SanPham "
                + "where SanPham.MaSanPham = ChiTietThongKe.MaSanPham "
                + " "+ wheredk
                + "group by TenSanPham,GiaNhap,HeSo";
                
        ResultSet rs = cnn.ExcuteQueryGetTable(cautruyvan);
        Object[] obj = new Object[]{"Tên Sản Phẩm", "Số Lượng Bán Được","Tổng Tiền"};
        DefaultTableModel tableModel = new DefaultTableModel(obj, 0);
        tblChiTietBan.setModel(tableModel);
        System.out.println(cautruyvan);
        try {
            while (rs.next()) {
                
                Object[] item = new Object[3]; 
                item[0] = rs.getString("TenSanPham");
                item[1] = rs.getInt("SoLuong");
                long Tong  = rs.getLong("TongTien");
                String str = currencyVN.format(Tong);
                item[2]= str;
                tableModel.addRow(item);
            }
        } catch (SQLException ex) {
            System.out.println(ex.toString());
        }
    }
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnOK;
    private javax.swing.JButton btnSua;
    private javax.swing.JButton btnThemVon;
    private javax.swing.JButton btnThuHoiVon;
    private javax.swing.JButton btnXuatLo;
    private javax.swing.JButton btnXuatLoi;
    private javax.swing.JComboBox<String> cbbNam1;
    private javax.swing.JComboBox<String> cbbNam2;
    private javax.swing.JComboBox<String> cbbNgay1;
    private javax.swing.JComboBox<String> cbbNgay2;
    private javax.swing.JComboBox<String> cbbThang1;
    private javax.swing.JComboBox<String> cbbThang2;
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JButton jButton3;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel17;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel19;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel20;
    private javax.swing.JLabel jLabel21;
    private javax.swing.JLabel jLabel22;
    private javax.swing.JLabel jLabel23;
    private javax.swing.JLabel jLabel24;
    private javax.swing.JLabel jLabel25;
    private javax.swing.JLabel jLabel26;
    private javax.swing.JLabel jLabel27;
    private javax.swing.JLabel jLabel28;
    private javax.swing.JLabel jLabel29;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel30;
    private javax.swing.JLabel jLabel31;
    private javax.swing.JLabel jLabel32;
    private javax.swing.JLabel jLabel33;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel10;
    private javax.swing.JPanel jPanel11;
    private javax.swing.JPanel jPanel12;
    private javax.swing.JPanel jPanel13;
    private javax.swing.JPanel jPanel14;
    private javax.swing.JPanel jPanel15;
    private javax.swing.JPanel jPanel16;
    private javax.swing.JPanel jPanel17;
    private javax.swing.JPanel jPanel18;
    private javax.swing.JPanel jPanel19;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel20;
    private javax.swing.JPanel jPanel21;
    private javax.swing.JPanel jPanel22;
    private javax.swing.JPanel jPanel23;
    private javax.swing.JPanel jPanel24;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JPanel jPanel8;
    private javax.swing.JPanel jPanel9;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JScrollPane jScrollPane5;
    private javax.swing.JScrollPane jScrollPane6;
    private javax.swing.JScrollPane jScrollPane7;
    private javax.swing.JScrollPane jScrollPane8;
    private javax.swing.JTabbedPane jTabbedPane1;
    private javax.swing.JTabbedPane jTabbedPane2;
    private javax.swing.JTable tblChiTietBan;
    private javax.swing.JTable tblGiaDoan;
    private javax.swing.JTable tblLo;
    private javax.swing.JTable tblQuyetToan;
    private javax.swing.JTable tblThongKeChiTiet;
    private javax.swing.JTable tblVonThem;
    private javax.swing.JTable tblVonThuHoi;
    private javax.swing.JTextField txtChiPhiPhatSinhTK;
    private javax.swing.JTextArea txtGhiChuVonThem;
    private javax.swing.JTextField txtLo;
    private javax.swing.JTextField txtLoiNhuan;
    private javax.swing.JTextField txtLoiNhuanTK;
    private javax.swing.JTextField txtLuongNVTK;
    private javax.swing.JTextField txtMaVOn;
    private javax.swing.JTextField txtNgayBatDau;
    private javax.swing.JTextField txtNgayBatDau1;
    private javax.swing.JTextField txtNgayKeThuc;
    private javax.swing.JTextField txtNgayKeThuc1;
    private javax.swing.JTextField txtPhiBaoHanh;
    private javax.swing.JTextField txtPhiBaoHanhLo;
    private javax.swing.JTextField txtPhiBaoHanhTK;
    private javax.swing.JTextField txtThuaLoTK;
    private javax.swing.JTextField txtTienDien;
    private javax.swing.JTextField txtTienDienThoai;
    private javax.swing.JTextField txtTienInternet;
    private javax.swing.JTextField txtTienMatBang;
    private javax.swing.JTextField txtTienNuoc;
    private javax.swing.JTextField txtTongDoanhThuLo;
    private javax.swing.JTextField txtTongDoanhThuLoi;
    private javax.swing.JTextField txtTongTK;
    private javax.swing.JTextField txtTongVoLo;
    private javax.swing.JTextField txtTongVonBanDauLoi;
    private javax.swing.JTextField txtVonThem;
    // End of variables declaration//GEN-END:variables
}
